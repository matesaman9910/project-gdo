<!DOCTYPE html>
<html lang="en" type="module">
<head>
  <meta charset="UTF-8" />
  <title>SGC Listener</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    #listenerUI { display: none; }
  </style>
</head>
<body>
  <h1>SGC Command Terminal</h1>

  <!-- Login UI -->
  <div id="loginUI">
    <h2>Sign in to SGC</h2>
    <button id="googleSignIn">Sign in with Google</button>
  </div>

  <!-- Listener UI -->
  <div id="listenerUI">
    <div>
      <label>Select Frequency:</label>
      <select id="frequencySelect">
        <option value="alpha-1">Alpha-1</option>
        <option value="bravo-2">Bravo-2</option>
      </select>
    </div>
    <div id="log"></div>
  </div>

  <script type="module">
    // Firebase CDN imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";

    // Your Firebase config (from your snippet)
    const firebaseConfig = {
      apiKey: "AIzaSyAn5rsOUfkKBYhpQb3qwdUTElJP8Kg0dW0",
      authDomain: "project-gdo.firebaseapp.com",
      databaseURL: "https://project-gdo-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "project-gdo",
      storageBucket: "project-gdo.firebasestorage.app",
      messagingSenderId: "758705115255",
      appId: "1:758705115255:web:878f5e64c164b75c507672"
    };

    // Initialize Firebase app and auth
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    // UI elements
    const loginUI = document.getElementById('loginUI');
    const listenerUI = document.getElementById('listenerUI');
    const googleSignInBtn = document.getElementById('googleSignIn');

    googleSignInBtn.addEventListener('click', () => {
      signInWithPopup(auth, provider).catch(console.error);
    });

    onAuthStateChanged(auth, user => {
      if (user) {
        // User signed in — show listener UI
        loginUI.style.display = 'none';
        listenerUI.style.display = 'block';
        initListener();
      } else {
        // User signed out — show login UI
        loginUI.style.display = 'block';
        listenerUI.style.display = 'none';
      }
    });

    // Placeholder for listener logic — replace with your script.js code here
    function initListener() {
      const log = document.getElementById('log');
      const freqSelect = document.getElementById('frequencySelect');

      log.textContent = 'Waiting for signals on frequency: ' + freqSelect.value;

      freqSelect.addEventListener('change', () => {
        log.textContent = 'Waiting for signals on frequency: ' + freqSelect.value;
      });

      // TODO: Add your Firebase Realtime Database listener here to update #log
    }
  </script>
</body>
</html>
